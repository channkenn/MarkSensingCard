<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>4Êäû„ÇØ„Ç§„Ç∫</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        text-align: center;
      }
      #quiz-container {
        margin: 20px auto;
        width: 90%;
        max-width: 400px;
      }
      #question-number {
        font-size: 16px;
        margin-bottom: 5px;
      }
      #options {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 10px;
        margin-top: 10px;
      }
      .option {
        padding: 10px;
        font-size: 16px;
        border: 1px solid #333;
        background-color: #f9f9f9;
        cursor: pointer;
      }
      .option:hover {
        background-color: #ddd;
      }
      .correct {
        background-color: #4caf50;
        color: white;
      } /* Ê≠£Ëß£„ÅÆËâ≤ */
      #result {
        margin-top: 15px;
        font-weight: bold;
        font-size: 18px;
      }
      #next {
        margin-top: 10px;
        padding: 10px;
        font-size: 16px;
        display: none;
      }
    </style>
  </head>
  <body>
    <div id="quiz-container">
      <p id="question-number"></p>
      <!-- ‰ΩïÂïèÁõÆ„Åã„ÇíË°®Á§∫ -->
      <h2 id="question">ÂïèÈ°åÊñá</h2>
      <div id="options"></div>
      <p id="result"></p>
      <button id="next">Ê¨°„ÅÆÂïèÈ°å„Å∏</button>
    </div>

    <script>
      let questions = [];
      let currentQuestionIndex = 0;
      let correctCount = 0; // Ê≠£Ëß£Êï∞„Ç´„Ç¶„É≥„Éà

      async function loadCSV() {
        const response = await fetch("questions.csv");
        const text = await response.text();
        const lines = text.trim().split("\n");

        // 1Ë°åÁõÆÔºà„Éò„ÉÉ„ÉÄ„ÉºÔºâ„Çí„Çπ„Ç≠„ÉÉ„Éó
        questions = lines.slice(1).map((line) => {
          const [question, a, b, c, d, answer] = line.split(",");
          return { question, options: [a, b, c, d], answer };
        });

        showQuestion();
      }

      function showQuestion() {
        const q = questions[currentQuestionIndex];
        document.getElementById("question-number").textContent = `ÂïèÈ°å ${
          currentQuestionIndex + 1
        } / ${questions.length}`;
        document.getElementById("question").textContent = q.question;
        document.getElementById("result").textContent = "";
        document.getElementById("options").innerHTML = "";
        document.getElementById("next").style.display = "none";

        const labels = ["A", "B", "C", "D"];
        q.options.forEach((option, index) => {
          const btn = document.createElement("button");
          btn.textContent = `${labels[index]}: ${option}`;
          btn.className = "option";
          btn.dataset.answer = labels[index]; // A, B, C, D „Çí„Éá„Éº„ÇøÂ±ûÊÄß„Å®„Åó„Å¶‰øùÂ≠ò
          btn.onclick = () => checkAnswer(labels[index]); // „ÇØ„É™„ÉÉ„ÇØÊôÇ„Å´Âà§ÂÆö
          document.getElementById("options").appendChild(btn);
        });
      }

      function checkAnswer(selected) {
        const q = questions[currentQuestionIndex];
        const correctAnswer = q.answer;
        const buttons = document.querySelectorAll(".option");

        buttons.forEach((btn) => {
          btn.onclick = null; // ÈÅ∏ÊäûÂæå„ÅØ„Éú„Çø„É≥ÁÑ°ÂäπÂåñ
          if (btn.dataset.answer === correctAnswer) {
            btn.classList.add("correct"); // Ê≠£Ëß£„ÇíÁ∑ëËâ≤„Å´
          }
        });

        if (selected === correctAnswer) {
          document.getElementById("result").textContent = "Ê≠£Ëß£„Åß„Åô üéâ";
          correctCount++; // Ê≠£Ëß£Êï∞„Çí„Ç´„Ç¶„É≥„Éà
        } else {
          document.getElementById(
            "result"
          ).textContent = `‰∏çÊ≠£Ëß£„Åß„Åô ‚ùå Ê≠£Ëß£„ÅØ ${correctAnswer} „Åß„Åô`;
        }
        document.getElementById("next").style.display = "block";
      }

      document.getElementById("next").addEventListener("click", () => {
        currentQuestionIndex++;
        if (currentQuestionIndex < questions.length) {
          showQuestion();
        } else {
          document.getElementById("quiz-container").innerHTML = `
                    <h2>„ÉÜ„Çπ„ÉàÁµÇ‰∫Ü</h2>
                    <p>ÁµêÊûú: ${questions.length} Âïè‰∏≠ ${correctCount} ÂïèÊ≠£Ëß£</p>
                `;
        }
      });

      loadCSV();
    </script>
  </body>
</html>
